---
/*
  BeanCard.astro
  A card component for displaying a bean preview.
  Used on: /beans listing page, shop detail page.
*/

import Rating from './Rating.astro';

interface Props {
  id: string;         // Slug used for the link URL
  name: string;
  roaster: string;
  origin: string;
  rating: number;
  tastingNotes: string[];
  roastLevel?: string;
  image?: string;
}

const { id, name, roaster, origin, rating, tastingNotes, roastLevel, image } = Astro.props;
---

<a href={`/beans/${id}`} class="group block">
  <article class="bg-warm-white rounded-xl overflow-hidden shadow-sm hover:shadow-md transition-shadow">

    <!-- Bean image -->
    <div class="aspect-square overflow-hidden bg-espresso/10">
      {image ? (
        <img
          src={image}
          alt={`${name} by ${roaster}`}
          class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
          loading="lazy"
          onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"
        />
      ) : null}
      <!-- Placeholder shown when no image -->
      <div class:list={[
        "w-full h-full items-center justify-center bg-espresso/5",
        image ? "hidden" : "flex"
      ]}>
        <span class="text-4xl">ðŸ«˜</span>
      </div>
    </div>

    <!-- Card content -->
    <div class="p-5">
      <!-- Bean name -->
      <h3 class="font-heading text-lg font-bold text-espresso group-hover:text-rust transition-colors">
        {name}
      </h3>

      <!-- Roaster and origin -->
      <p class="text-sm text-charcoal/60 mt-1">
        {roaster} Â· {origin}
      </p>

      <!-- Roast level badge -->
      {roastLevel && (
        <span class="inline-block mt-2 text-xs px-2 py-1 bg-rust/10 text-rust rounded-full">
          {roastLevel}
        </span>
      )}

      <!-- Rating -->
      <div class="mt-3">
        <Rating rating={rating} size="sm" />
      </div>

      <!-- Tasting notes -->
      <div class="mt-3 flex flex-wrap gap-1.5">
        {tastingNotes.slice(0, 4).map(note => (
          <span class="text-xs px-2 py-1 bg-sage/15 text-sage rounded-full">
            {note}
          </span>
        ))}
      </div>
    </div>
  </article>
</a>
